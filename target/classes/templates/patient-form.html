<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Medical Recommendation System</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        .form-section {
            background-color: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
        }
        .error-message {
            color: #dc3545;
            font-size: 0.875em;
            margin-top: 0.25rem;
        }
    </style>
</head>
<body>
    <div class="container mt-4 mb-4">
        <h2 class="text-center mb-4">Medical Recommendation System</h2>
        
        <form th:action="@{/generate}" th:object="${patient}" method="post" class="needs-validation" novalidate>
            <!-- Basic Information -->
            <div class="form-section">
                <h4 class="mb-3">Basic Information</h4>
                <div class="row">
                    <div class="col-md-6 mb-3">
                        <label class="form-label">Gender*</label>
                        <select th:field="*{gender}" class="form-select" required>
                            <option value="">Select gender</option>
                            <option value="male">Male</option>
                            <option value="female">Female</option>
                        </select>
                        <div th:if="${#fields.hasErrors('gender')}" class="error-message" 
                             th:errors="*{gender}"></div>
                    </div>
                    
                    <div class="col-md-6 mb-3">
                        <label class="form-label">Age*</label>
                        <input type="number" th:field="*{age}" class="form-control" required
                               min="0" max="150"/>
                        <div th:if="${#fields.hasErrors('age')}" class="error-message" 
                             th:errors="*{age}"></div>
                    </div>
                </div>

                <div class="row">
                    <div class="col-md-4">
                        <div class="form-check mb-3">
                            <input type="checkbox" th:field="*{smoking}" class="form-check-input" id="smoking"/>
                            <label class="form-check-label" for="smoking">Smoking</label>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="form-check mb-3">
                            <input type="checkbox" th:field="*{alcoholConsumption}" class="form-check-input" id="alcohol"/>
                            <label class="form-check-label" for="alcohol">Alcohol Consumption</label>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="form-check mb-3" id="pregnantSection" style="display: none;">
                            <input type="checkbox" th:field="*{pregnant}" class="form-check-input" id="pregnant"/>
                            <label class="form-check-label" for="pregnant">Pregnant</label>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Vital Signs -->
            <div class="form-section">
                <h4 class="mb-3">Vital Signs</h4>
                <div class="row">
                    <div class="col-md-6 mb-3">
                        <label class="form-label">Systolic Pressure* (mmHg)</label>
                        <input type="number" th:field="*{systolicPressure}" class="form-control" required
                               min="70" max="200"/>
                        <div th:if="${#fields.hasErrors('systolicPressure')}" class="error-message" 
                             th:errors="*{systolicPressure}"></div>
                    </div>
                    
                    <div class="col-md-6 mb-3">
                        <label class="form-label">Diastolic Pressure* (mmHg)</label>
                        <input type="number" th:field="*{diastolicPressure}" class="form-control" required
                               min="40" max="130"/>
                        <div th:if="${#fields.hasErrors('diastolicPressure')}" class="error-message" 
                             th:errors="*{diastolicPressure}"></div>
                    </div>
                </div>

                <div class="row">
                    <div class="col-md-3 mb-3">
                        <label class="form-label">Pulse* (bpm)</label>
                        <input type="number" th:field="*{pulse}" class="form-control" required
                               min="40" max="200"/>
                        <div th:if="${#fields.hasErrors('pulse')}" class="error-message" 
                             th:errors="*{pulse}"></div>
                    </div>
                    
                    <div class="col-md-3 mb-3">
                        <label class="form-label">Respiratory Rate* (rpm)</label>
                        <input type="number" th:field="*{respiratoryRate}" class="form-control" required
                               min="8" max="40"/>
                        <div th:if="${#fields.hasErrors('respiratoryRate')}" class="error-message" 
                             th:errors="*{respiratoryRate}"></div>
                    </div>
                    
                    <div class="col-md-3 mb-3">
                        <label class="form-label">Temperature* (Â°C)</label>
                        <input type="number" step="0.1" th:field="*{temperature}" class="form-control" required
                               min="35.0" max="42.0"/>
                        <div th:if="${#fields.hasErrors('temperature')}" class="error-message" 
                             th:errors="*{temperature}"></div>
                    </div>
                </div>

                <div class="row">
                    <div class="col-md-6 mb-3">
                        <label class="form-label">Weight* (kg)</label>
                        <input type="number" step="0.1" th:field="*{weight}" class="form-control" required
                               min="20.0" max="300.0"/>
                        <div th:if="${#fields.hasErrors('weight')}" class="error-message" 
                             th:errors="*{weight}"></div>
                    </div>
                    
                    <div class="col-md-6 mb-3">
                        <label class="form-label">Height* (cm)</label>
                        <input type="number" step="0.1" th:field="*{height}" class="form-control" required
                               min="100.0" max="250.0"/>
                        <div th:if="${#fields.hasErrors('height')}" class="error-message" 
                             th:errors="*{height}"></div>
                    </div>
                </div>
            </div>

            <!-- Laboratory Results -->
            <div class="form-section">
                <h4 class="mb-3">Laboratory Results</h4>
                <div class="row">
                    <div class="col-md-3 mb-3">
                        <label class="form-label">Haemoglobin* (g/dL)</label>
                        <input type="number" step="0.1" th:field="*{haemoglobin}" class="form-control" required/>
                        <div th:if="${#fields.hasErrors('haemoglobin')}" class="error-message" 
                             th:errors="*{haemoglobin}"></div>
                    </div>
                    
                    <div class="col-md-3 mb-3">
                        <label class="form-label">Eosinophil* (%)</label>
                        <input type="number" step="0.1" th:field="*{eosinophil}" class="form-control" required/>
                        <div th:if="${#fields.hasErrors('eosinophil')}" class="error-message" 
                             th:errors="*{eosinophil}"></div>
                    </div>
                    
                    <div class="col-md-3 mb-3">
                        <label class="form-label">MCV* (fL)</label>
                        <input type="number" step="0.1" th:field="*{mcv}" class="form-control" required/>
                        <div th:if="${#fields.hasErrors('mcv')}" class="error-message" 
                             th:errors="*{mcv}"></div>
                    </div>
                    
                    <div class="col-md-3 mb-3">
                        <label class="form-label">LED* (mm/hour)</label>
                        <input type="number" th:field="*{led}" class="form-control" required/>
                        <div th:if="${#fields.hasErrors('led')}" class="error-message" 
                             th:errors="*{led}"></div>
                    </div>
                </div>

                <div class="row">
                    <div class="col-md-4 mb-3">
                        <label class="form-label">Uric Acid* (mg/dL)</label>
                        <input type="number" step="0.1" th:field="*{uricAcid}" class="form-control" required/>
                        <div th:if="${#fields.hasErrors('uricAcid')}" class="error-message" 
                             th:errors="*{uricAcid}"></div>
                    </div>
                    
                    <div class="col-md-4 mb-3">
                        <label class="form-label">Glucose* (mg/dL)</label>
                        <input type="number" step="0.1" th:field="*{glucose}" class="form-control" required/>
                        <div th:if="${#fields.hasErrors('glucose')}" class="error-message" 
                             th:errors="*{glucose}"></div>
                    </div>
                    
                    <div class="col-md-4 mb-3">
                        <label class="form-label">Total Cholesterol* (mg/dL)</label>
                        <input type="number" step="0.1" th:field="*{totalCholesterol}" class="form-control" required/>
                        <div th:if="${#fields.hasErrors('totalCholesterol')}" class="error-message" 
                             th:errors="*{totalCholesterol}"></div>
                    </div>
                </div>

                <div class="row">
                    <div class="col-md-4 mb-3">
                        <label class="form-label">Triglyceride* (mg/dL)</label>
                        <input type="number" step="0.1" th:field="*{triglyceride}" class="form-control" required/>
                        <div th:if="${#fields.hasErrors('triglyceride')}" class="error-message" 
                             th:errors="*{triglyceride}"></div>
                    </div>
                    
                    <div class="col-md-4 mb-3">
                        <label class="form-label">HDL* (mg/dL)</label>
                        <input type="number" th:field="*{hdl}" class="form-control" required/>
                        <div th:if="${#fields.hasErrors('hdl')}" class="error-message" 
                             th:errors="*{hdl}"></div>
                    </div>
                    
                    <div class="col-md-4 mb-3">
                        <label class="form-label">LDL* (mg/dL)</label>
                        <input type="number" th:field="*{ldl}" class="form-control" required/>
                        <div th:if="${#fields.hasErrors('ldl')}" class="error-message" 
                             th:errors="*{ldl}"></div>
                    </div>
                </div>
            </div>

            <div class="text-center">
                <button type="submit" class="btn btn-primary btn-lg">Generate Report</button>
            </div>
        </form>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // Show/hide pregnancy checkbox based on gender
        document.querySelector('select[name="gender"]').addEventListener('change', function() {
            const pregnantSection = document.getElementById('pregnantSection');
            if (this.value === 'female') {
                pregnantSection.style.display = 'block';
            } else {
                pregnantSection.style.display = 'none';
                document.getElementById('pregnant').checked = false;
            }
        });

        // Form validation
        (function () {
            'use strict'
            var forms = document.querySelectorAll('.needs-validation')
            Array.prototype.slice.call(forms)
                .forEach(function (form) {
                    form.addEventListener('submit', function (event) {
                        if (!form.checkValidity()) {
                            event.preventDefault()
                            event.stopPropagation()
                        }
                        form.classList.add('was-validated')
                    }, false)
                })
        })()
    </script>
</body>
</html>
